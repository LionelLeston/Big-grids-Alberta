allgrids<-read.csv("allgrids.csv", header=TRUE)
str(allgrids)#5676 obs

library(dplyr)
library(tidyr)
allgrids.summ<-allgrids%>%
  group_by(StationKey)%>%
  summarise_at(vars(ALFL:YWAR), funs(mean, max))
allgrids.summ<-data.frame(allgrids.summ)

tobinary<-function(x){
  y<-ifelse(x>0,1,0)
  return(y)
}
allgrids.binary<-allgrids.summ%>%
  group_by(StationKey)%>%
  summarise_at(vars(ALFL_max:YWAR_max), funs(tobinary))
allgrids.summ2<-merge(allgrids.summ, allgrids.binary, by=c("StationKey"))
allgrids.summ2<-allgrids.summ2[,c("StationKey","ALFL_mean","ALFL_max.x","ALFL_max.y",
                                  "AMBI_mean","AMBI_max.x","AMBI_max.y",
                                  "AMCO_mean","AMCO_max.x","AMCO_max.y",
                                  "AMCR_mean","AMCR_max.x","AMCR_max.y",
                                  "AMGO_mean","AMGO_max.x","AMGO_max.y",
                                  "AMKE_mean","AMKE_max.x","AMKE_max.y",
                                  "AMRE_mean","AMRE_max.x","AMRE_max.y",
                                  "AMRO_mean","AMRO_max.x","AMRO_max.y",
                                  "AMWI_mean","AMWI_max.x","AMWI_max.y",
                                  "ATSP_mean","ATSP_max.x","ATSP_max.y",
                                  "ATTW_mean","ATTW_max.x","ATTW_max.y",
                                  "BADO_mean","BADO_max.x","BADO_max.y",
                                  "BANS_mean","BANS_max.x","BANS_max.y",
                                  "BAOR_mean","BAOR_max.x","BAOR_max.y",
                                  "BARS_mean","BARS_max.x","BARS_max.y",
                                  "BAWA_mean","BAWA_max.x","BAWA_max.y",
                                  "BAWW_mean","BAWW_max.x","BAWW_max.y",
                                  "BBCU_mean","BBCU_max.x","BBCU_max.y",
                                  "BBMA_mean","BBMA_max.x","BBMA_max.y",
                                  "BBWA_mean","BBWA_max.x","BBWA_max.y",
                                  "BBWO_mean","BBWO_max.x","BBWO_max.y",
                                  "BCCH_mean","BCCH_max.x","BCCH_max.y",
                                  "BCFR_mean","BCFR_max.x","BCFR_max.y",
                                  "BEAV_mean","BEAV_max.x","BEAV_max.y",
                                  "BEKI_mean","BEKI_max.x","BEKI_max.y",
                                  "BHCO_mean","BHCO_max.x","BHCO_max.y",
                                  "BHVI_mean","BHVI_max.x","BHVI_max.y",
                                  "BLBW_mean","BLBW_max.x","BLBW_max.y",
                                  "BLJA_mean","BLJA_max.x","BLJA_max.y",
                                  "BLPW_mean","BLPW_max.x","BLPW_max.y",
                                  "BLTE_mean","BLTE_max.x","BLTE_max.y",
                                  "BOCH_mean","BOCH_max.x","BOCH_max.y",
                                  "BOGU_mean","BOGU_max.x","BOGU_max.y",
                                  "BOOW_mean","BOOW_max.x","BOOW_max.y",
                                  "BOWA_mean","BOWA_max.x","BOWA_max.y",
                                  "BRBL_mean","BRBL_max.x","BRBL_max.y",
                                  "BRCR_mean","BRCR_max.x","BRCR_max.y",
                                  "BTNW_mean","BTNW_max.x","BTNW_max.y",
                                  "BWHA_mean","BWHA_max.x","BWHA_max.y",
                                  "BWTE_mean","BWTE_max.x","BWTE_max.y",
                                  "BWWA_mean","BWWA_max.x","BWWA_max.y",
                                  "CAGU_mean","CAGU_max.x","CAGU_max.y",
                                  "CANG_mean","CANG_max.x","CANG_max.y",
                                  "CATO_mean","CATO_max.x","CATO_max.y",
                                  "CAWA_mean","CAWA_max.x","CAWA_max.y",
                                  "CCLO_mean","CCLO_max.x","CCLO_max.y",
                                  "CCSP_mean","CCSP_max.x","CCSP_max.y",
                                  "CEDW_mean","CEDW_max.x","CEDW_max.y",
                                  "CHSP_mean","CHSP_max.x","CHSP_max.y",
                                  "CLNU_mean","CLNU_max.x","CLNU_max.y",
                                  "CMWA_mean","CMWA_max.x","CMWA_max.y",
                                  "COGR_mean","COGR_max.x","COGR_max.y",
                                  "COLO_mean","COLO_max.x","COLO_max.y",
                                  "CONI_mean","CONI_max.x","CONI_max.y",
                                  "CONW_mean","CONW_max.x","CONW_max.y",
                                  "CORA_mean","CORA_max.x","CORA_max.y",
                                  "CORE_mean","CORE_max.x","CORE_max.y",
                                  "COWW_mean","COWW_max.x","COWW_max.y",
                                  "COTE_mean","COTE_max.x","COTE_max.y",
                                  "COYE_mean","COYE_max.x","COYE_max.y",
                                  "COYT_mean","COYT_max.x","COYT_max.y",
                                  "CRCH_mean","CRCH_max.x","CRCH_max.y",
                                  "CSWA_mean","CSWA_max.x","CSWA_max.y",
                                  "DEJU_mean","DEJU_max.x","DEJU_max.y",
                                  "DOGG_mean","DOGG_max.x","DOGG_max.y",
                                  "DOWO_mean","DOWO_max.x","DOWO_max.y",
                                  "DUGR_mean","DUGR_max.x","DUGR_max.y",
                                  "EAKI_mean","EAKI_max.x","EAKI_max.y",
                                  "EAPH_mean","EAPH_max.x","EAPH_max.y",
                                  "EUST_mean","EUST_max.x","EUST_max.y",
                                  "EVGR_mean","EVGR_max.x","EVGR_max.y",
                                  "FOSP_mean","FOSP_max.x","FOSP_max.y",
                                  "FOTE_mean","FOTE_max.x","FOTE_max.y",
                                  "FRGU_mean","FRGU_max.x","FRGU_max.y",
                                  "GADW_mean","GADW_max.x","GADW_max.y",
                                  "GBHE_mean","GBHE_max.x","GBHE_max.y",
                                  "GCKI_mean","GCKI_max.x","GCKI_max.y",
                                  "GCTH_mean","GCTH_max.x","GCTH_max.y",
                                  "GGOW_mean","GGOW_max.x","GGOW_max.y",
                                  "GHOW_mean","GHOW_max.x","GHOW_max.y",
                                  "GRAJ_mean","GRAJ_max.x","GRAJ_max.y",
                                  "GRCA_mean","GRCA_max.x","GRCA_max.y",
                                  "GRYE_mean","GRYE_max.x","GRYE_max.y",
                                  "GWFG_mean","GWFG_max.x","GWFG_max.y",
                                  "HASP_mean","HASP_max.x","HASP_max.y",
                                  "HAWO_mean","HAWO_max.x","HAWO_max.y",
                                  "HETH_mean","HETH_max.x","HETH_max.y",
                                  "HOFI_mean","HOFI_max.x","HOFI_max.y",
                                  "HOSP_mean","HOSP_max.x","HOSP_max.y",
                                  "HOWR_mean","HOWR_max.x","HOWR_max.y",
                                  "KILL_mean","KILL_max.x","KILL_max.y",
                                  "LALO_mean","LALO_max.x","LALO_max.y",
                                  "LBCU_mean","LBCU_max.x","LBCU_max.y",
                                  "LCSP_mean","LCSP_max.x","LCSP_max.y",
                                  "LEFL_mean","LEFL_max.x","LEFL_max.y",
                                  "LESC_mean","LESC_max.x","LESC_max.y",
                                  "LEYE_mean","LEYE_max.x","LEYE_max.y",
                                  "LISP_mean","LISP_max.x","LISP_max.y",
                                  "MALL_mean","MALL_max.x","MALL_max.y",
                                  "MAWA_mean","MAWA_max.x","MAWA_max.y",
                                  "MAWR_mean","MAWR_max.x","MAWR_max.y",
                                  "MEGU_mean","MEGU_max.x","MEGU_max.y",
                                  "MERL_mean","MERL_max.x","MERL_max.y",
                                  "MGWA_mean","MGWA_max.x","MGWA_max.y",
                                  "MOBL_mean","MOBL_max.x","MOBL_max.y",
                                  "MODO_mean","MODO_max.x","MODO_max.y",
                                  "MOWA_mean","MOWA_max.x","MOWA_max.y",
                                  "MYWA_mean","MYWA_max.x","MYWA_max.y",
                                  "NAWA_mean","NAWA_max.x","NAWA_max.y",
                                  "NESP_mean","NESP_max.x","NESP_max.y",
                                  "NOBO_mean","NOBO_max.x","NOBO_max.y",
                                  "NOFL_mean","NOFL_max.x","NOFL_max.y",
                                  "NOGO_mean","NOGO_max.x","NOGO_max.y",
                                  "NOPA_mean","NOPA_max.x","NOPA_max.y",
                                  "NOPO_mean","NOPO_max.x","NOPO_max.y",
                                  "NOWA_mean","NOWA_max.x","NOWA_max.y",
                                  "NRWS_mean","NRWS_max.x","NRWS_max.y",
                                  "NSWO_mean","NSWO_max.x","NSWO_max.y",
                                  "OCWA_mean","OCWA_max.x","OCWA_max.y",
                                  "OSFL_mean","OSFL_max.x","OSFL_max.y",
                                  "OSPR_mean","OSPR_max.x","OSPR_max.y",
                                  "OVEN_mean","OVEN_max.x","OVEN_max.y",
                                  "PAWA_mean","PAWA_max.x","PAWA_max.y",
                                  "PBGR_mean","PBGR_max.x","PBGR_max.y",
                                  "PHVI_mean","PHVI_max.x","PHVI_max.y",
                                  "PISI_mean","PISI_max.x","PISI_max.y",
                                  "PIWO_mean","PIWO_max.x","PIWO_max.y",
                                  "PSFL_mean","PSFL_max.x","PSFL_max.y",
                                  "PUFI_mean","PUFI_max.x","PUFI_max.y",
                                  "RBGR_mean","RBGR_max.x","RBGR_max.y",
                                  "RBGU_mean","RBGU_max.x","RBGU_max.y",
                                  "RBNU_mean","RBNU_max.x","RBNU_max.y",
                                  "RCKI_mean","RCKI_max.x","RCKI_max.y",
                                  "RECR_mean","RECR_max.x","RECR_max.y",
                                  "REDH_mean","REDH_max.x","REDH_max.y",
                                  "RESQ_mean","RESQ_max.x","RESQ_max.y",
                                  "REVI_mean","REVI_max.x","REVI_max.y",
                                  "RNGR_mean","RNGR_max.x","RNGR_max.y",
                                  "RNSA_mean","RNSA_max.x","RNSA_max.y",
                                  "RTHA_mean","RTHA_max.x","RTHA_max.y",
                                  "RUBL_mean","RUBL_max.x","RUBL_max.y",
                                  "RUGR_mean","RUGR_max.x","RUGR_max.y",
                                  "RWBL_mean","RWBL_max.x","RWBL_max.y",
                                  "SACR_mean","SACR_max.x","SACR_max.y",
                                  "SAVS_mean","SAVS_max.x","SAVS_max.y",
                                  "SBDO_mean","SBDO_max.x","SBDO_max.y",
                                  "SCTA_mean","SCTA_max.x","SCTA_max.y",
                                  "SEWR_mean","SEWR_max.x","SEWR_max.y",
                                  "SORA_mean","SORA_max.x","SORA_max.y",
                                  "SOSA_mean","SOSA_max.x","SOSA_max.y",
                                  "SOSP_mean","SOSP_max.x","SOSP_max.y",
                                  "SPGR_mean","SPGR_max.x","SPGR_max.y",
                                  "SPPE_mean","SPPE_max.x","SPPE_max.y",
                                  "SPSA_mean","SPSA_max.x","SPSA_max.y",
                                  "SPTO_mean","SPTO_max.x","SPTO_max.y",
                                  "STGR_mean","STGR_max.x","STGR_max.y",
                                  "SWSP_mean","SWSP_max.x","SWSP_max.y",
                                  "SWTH_mean","SWTH_max.x","SWTH_max.y",
                                  "TEWA_mean","TEWA_max.x","TEWA_max.y",
                                  "TOSO_mean","TOSO_max.x","TOSO_max.y",
                                  "TRES_mean","TRES_max.x","TRES_max.y",
                                  "VATH_mean","VATH_max.x","VATH_max.y",
                                  "VESP_mean","VESP_max.x","VESP_max.y",
                                  "VIRA_mean","VIRA_max.x","VIRA_max.y",
                                  "WAVI_mean","WAVI_max.x","WAVI_max.y",
                                  "WBNU_mean","WBNU_max.x","WBNU_max.y",
                                  "WCSP_mean","WCSP_max.x","WCSP_max.y",
                                  "WETA_mean","WETA_max.x","WETA_max.y",
                                  "WETO_mean","WETO_max.x","WETO_max.y",
                                  "WEWP_mean","WEWP_max.x","WEWP_max.y",
                                  "WILL_mean","WILL_max.x","WILL_max.y",
                                  "WISN_mean","WISN_max.x","WISN_max.y",
                                  "WIWA_mean","WIWA_max.x","WIWA_max.y",
                                  "WIWR_mean","WIWR_max.x","WIWR_max.y",
                                  "WOFR_mean","WOFR_max.x","WOFR_max.y",
                                  "WOLF_mean","WOLF_max.x","WOLF_max.y",
                                  "WTSP_mean","WTSP_max.x","WTSP_max.y",
                                  "WWCR_mean","WWCR_max.x","WWCR_max.y",
                                  "YBFL_mean","YBFL_max.x","YBFL_max.y",
                                  "YBSA_mean","YBSA_max.x","YBSA_max.y",
                                  "YELLOWRAIL_mean","YELLOWRAIL_max.x","YELLOWRAIL_max.y",
                                  "YEWA_mean","YEWA_max.x","YEWA_max.y",
                                  "YHBL_mean","YHBL_max.x","YHBL_max.y",
                                  "YRWA_mean","YRWA_max.x","YRWA_max.y",
                                  "YWAR_mean","YWAR_max.x","YWAR_max.y")]
write.csv(allgrids.summ2, "allgrids.summ.Oct15.csv")
#replace max.x with max, max.y with bin

